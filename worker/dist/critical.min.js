var critical=function(e){"use strict";function t(e,t){if(e.match(/^['"]?data:/))return e;const r=new URL(t,window.location),n=new URL(e,r);return r.protocol!=n.protocol||r.host!=n.host||n.host!=window.location.host||r.port!=n.port||n.port!=window.location.port||r.port!=n.port||n.protocol!=window.location.protocol?n.toString():n.pathname+n.search+n.hash}function r(e){return"/* font preloader script: "+e.length+' */\n"fonts" in document && '+JSON.stringify([...e],null,1)+".forEach(font => new FontFace(font.fontFamily, font.src, font.properties).load().then(font => document.fonts.add(font)))"}return e.extract=async function(e={}){const n=window.document,a=window.location,o=new Set,l=["all","print",""],s=[],i=window.innerHeight,c=n.createNodeIterator(n,NodeFilter.SHOW_ELEMENT,{acceptNode:function(e){return NodeFilter.SHOW_ELEMENT}}),f=new Set,d=new Set,u=new Map,m=new WeakMap;let p,h,y,S,g,w=0;for(performance.mark("filterStylesheets"),p=0;p<n.styleSheets.length;p++)if(h=n.styleSheets[p],"print"!=h.media.mediaText&&(""===h.media.mediaText||window.matchMedia(h.media.mediaText).matches))try{y=h.cssRules||h.rules||[];for(let e=0;e<y.length;e++)s.push({rule:y[e],match:!1})}catch(e){console.error(JSON.stringify({message:e.message,stylesheet:h.href},null,1))}if(performance.measure("filter stylesheets","filterStylesheets"),0===s.length)return{styles:[],fonts:[],nodeCount:w,stats:{nodeCount:w,stats:[]}};let x,E=s.length;for(performance.mark("nodeWalking");S=c.nextNode();){if(e.signal&&e.signal.aborted)return Promise.reject("Aborted");if(!["SCRIPT","LINK","HEAD","META","TITLE","NOSCRIPT"].includes(S.tagName)&&(w++,g=S.getBoundingClientRect(),g.top<i))for(p=0;p<E;p++)if(!s[p].match)if(m.set(s[p].rule,1),s[p].rule instanceof CSSStyleRule){let e,t=s[p].rule.selectorText;if(t.match(/(^|,|\s)::?((before)|(after))/))e=!0;else{t.match(/::?((before)|(after))/)&&(t=t.replace(/::?((before)|(after))\s*((,)|$)/g,"$5"));try{e=S.matches(t)}catch(t){s[p].rule.selectorText,e=S.matches(s[p].rule.selectorText)}}e&&(s[p].match=!0,s[p].rule.style.getPropertyValue("font-family")&&s[p].rule.style.getPropertyValue("font-family").split(/\s*,\s*/).forEach(e=>"inherit"!=e&&d.add(e.replace(/(['"])([^\1\s]+)\1/,"$2"))))}else if(s[p].rule instanceof CSSMediaRule||s[p].rule instanceof CSSImportRule){if("print"===s[p].rule.media.mediaText||""!==s[p].rule.media.mediaText&&!window.matchMedia(s[p].rule.media.mediaText).matches)continue;try{const e=s[p].rule,t=[],r=e instanceof CSSImportRule?e.styleSheet.cssRules||e.styleSheet.rules:e.cssRules||e.rules;for(let e=0;e<r.length;e++)m.has(r[e])||t.push({rule:r[e],match:!1});t.length>0&&(s.splice.apply(s,[p+1,0].concat(t)),E=s.length)}catch(e){console.error(JSON.stringify({message:e.message,stylesheet:h.href},null,1))}}else s[p].rule instanceof CSSFontFaceRule&&s[p].rule.style.getPropertyValue("font-family")&&s[p].rule.style.getPropertyValue("src")&&f.add(s[p].rule)}performance.measure("node walking","nodeWalking");let b="",T=-1;performance.mark("rulesExtraction");e:for(let e=0;e<E;e++){if(!s[e].match)continue;h=s[e].rule;let r=!1;if(u.has(h.parentStyleSheet)?b&&b!=u.get(h.parentStyleSheet).file&&(r=!0):(u.set(h.parentStyleSheet,{base:(h.parentStyleSheet.href&&h.parentStyleSheet.href.replace(/[?#].*/,"")||a.pathname).replace(/([^/]+)$/,""),file:h.parentStyleSheet.href||"inline #"+ ++T}),r=!0),r)try{u.get(h.parentStyleSheet).file,o.add("/* file: "+u.get(h.parentStyleSheet).file+" */")}catch(e){console.error(JSON.stringify(e.message,null,1)),console.error(JSON.stringify(h.parentStyleSheet&&h.parentStyleSheet.href,null,1))}for(b=u.get(h.parentStyleSheet).file,x=h.cssText,"inline"!=b&&(x=x.replace(/url\(([^)%\s]*?)\)/g,(function(e,r){return(r=r.trim()).match(/^['"]?data:/)?e:"url("+t(r=r.replace(/^(['"])([^\1\s]+)\1/,"$2"),u.get(h.parentStyleSheet).base)+")"})));h.parentRule;){if(h=h.parentRule,"print"==h.conditionText)continue e;if(l.includes(h.conditionText)||(x="@media "+h.conditionText+" {"+x+"}"),!h.parentRule)break}if(h.parentStyleSheet){let e=h.parentStyleSheet.media.mediaText;if("print"==e)continue e;l.includes(e)||(x="@media "+e+" {"+x+"}")}o.has(x)&&o.delete(x),o.add(x)}performance.measure("rules extraction","rulesExtraction");const C=new Map;if(e.fonts){let e,r,n,a,o;for(a of(performance.mark("fontsExtraction"),f))if(a.style.getPropertyValue("font-family").split(/\s*,\s*/).some(e=>d.has(e.replace(/(['"])([^\1\s]+)\1/,"$2")))){for(o={fontFamily:a.style.getPropertyValue("font-family").replace(/(['"])([^\1\s]+)\1/,"$2"),src:a.style.getPropertyValue("src").replace(/(^|[,\s*])local\([^)]+\)\s*,?\s*?/g,"").replace(/url\(([^)%\s]+)\)([^,]*)(,?)\s*/g,(e,r,n,o)=>(r=r.replace(/(['"])([^\1\s]+)\1/,"$2"),u.has(a.parentStyleSheet)||u.set(a.parentStyleSheet,{base:a.parentStyleSheet.href.replace(/([^/]+)$/,""),file:a.parentStyleSheet.href}),"url("+t(r,u.get(a.parentStyleSheet).base)+")"+o)).trim(),properties:{}},e=a.style.length;e--;)r=a.style.item(e),n=a.style.getPropertyValue(r),"font-family"!=r&&"src"!=r&&""!==n&&void 0!==n&&(o.properties[r.replace(/([A-Z])/g,(e,t)=>"-"+t.toLowerCase())]=n);C.set(JSON.stringify(o),o)}performance.measure("fonts extraction","fontsExtraction")}const N=performance.getEntriesByType("measure").filter(e=>["filter stylesheets","node walking","rules extraction","fonts extraction"].includes(e.name)).map(e=>({name:e.name,duration:(e.duration/1e3).toFixed(3)+"s"})),R={styles:[...o],fonts:[...C.values()],nodeCount:w,stats:{nodeCount:w,stats:N}};if(e.html){if(!n.querySelector("base")){const e=n.createElement("base"),t=n.querySelector("meta[charset]");e.href=a.protocol+"//"+a.host+a.pathname,n.head.insertBefore(e,t&&t.nextElementSibling||n.head.firstChild)}Array.from(n.querySelectorAll("style,link[rel=stylesheet]")).forEach(e=>{if(n.body.append(e),"LINK"==e.tagName){if("print"==e.media)return;e.hasAttribute("media")&&e.setAttribute("data-media",e.media),e.media="print",e.dataset.async=""}});const e=n.createElement("script");e.textContent="\n        window.addEventListener('DOMContentLoaded', () => Array.from(document.querySelectorAll('link[data-async]')).forEach(node => {\n\n                if(!node.hasAttribute('data-media')) {\n                    node.removeAttribute('media');\n                }\n                else {\n                    node.media=node.dataset.media;\n                    node.removeAttribute('data-media')\n                }\n                \n                node.removeAttribute('data-async');\n        }))",n.head.append(e);const t=n.createElement("style"),o=n.querySelector("base");if(t.dataset.critical=!0,t.textContent=R.styles.join("\n"),""!==t.textContent.trim()&&n.head.insertBefore(t,o&&o.nextElementSibling),R.fonts.length>0){const e=n.createElement("script");e.textContent=r(R.fonts),n.head.append(e)}const l=n.doctype;R.html="<!Doctype "+l.name+(l.publicId?` PUBLIC "${l.publicId}"`:"")+(l.systemId?(l.publicId?"":" SYSTEM")+` "${l.systemId}"`:"")+">\n"+n.documentElement.outerHTML}return R},e.fontscript=r,e}({});