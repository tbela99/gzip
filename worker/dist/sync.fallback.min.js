!function(){"use strict";const e={implement(e){const t=e.prototype,r=[].slice.call(arguments,1);let n,o,s;function makefunc(e,t,r){return function(){const n=this,o="previous"in n,s="parent"in n,a=n.previous,i=n.parent;n.previous=t,n.parent=r;const l=e.apply(n,arguments);return o&&(n.previous=a),s&&(n.parent=i),l}}for(n=0;n<r.length;n++)for(s in r[n])switch(o=r[n][s],typeof o){case"function":t[s]=makefunc(o,e[s],t[s]);break;case"object":t[s]=merge(!0,Array.isArray(o)?[]:{},o);break;default:t[s]=o}return e},merge:merge,reset:function reset(t){const r=e.getAllPropertiesName(t);let n,o,s=r.length;for(;s&&s--;)n=r[s],o=Object.getOwnPropertyDescriptor(t,n),null!=t[n]&&"object"==typeof t[n]&&null!=o&&"value"in o&&o.writable&&o.configurable&&(t[n]=merge(!0,Array.isArray(t[n])?[]:{},reset(t[n])));return t},extendArgs:e=>function(t){if("object"==typeof t){const r=[].slice.call(arguments,1);let n;for(n in t)e.apply(this,[n,t[n]].concat(r))}else e.apply(this,arguments);return this}};function merge(e){const t=[].slice.call(arguments,1);let r,n,o,s,a="boolean"==typeof e;for(!0===a&&(a=e,e=t.shift()),r=0;r<t.length;r++)if(n=t[r],null!=n)for(o in n)switch(s=n[o],typeof s){case"object":e[o]=null!=s&&a?merge(a,"object"==typeof e[o]&&null!=e[o]?e[o]:Array.isArray(s)?[]:{},s):s;break;default:e[o]=s}return e}function hashCode(e){var t,r=0;if(0===e.length)return r;for(t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return Number(r).toString(36)}const isCacheableRequest=(e,t)=>t instanceof Response&&("cors"==t.type||new URL(e.url,self.origin).origin==self.origin)&&"GET"==e.method&&t.ok&&["default","cors","basic","navigate"].includes(t.type)&&!t.bodyUsed,t=e.extendArgs,r={$events:{},$pseudo:{},on:t((function(e,t,r){const n=this;if(t==o)return;let s,a;const i=e=e.toLowerCase(),l={fn:t,cb:t,name:e,original:e,parsed:[e]};if(-1!=e.indexOf(":")){const t=e.match(/([^:]+):([^(]+)(\(([^)]+)\))?/);t==o?l.name=e=e.split(":",1)[0]:(l.original=e,l.name=t[1],l.parsed=t,e=t[1],t[2]in n.$pseudo&&n.$pseudo[t[2]](l))}e in n.$events||(n.$events[e]=[]),s=n.$events[e].length;for(;s&&s--;)if(a=n.$events[e][s],a.fn==t&&a.original==i)return;Object.defineProperty(l,"sticky",{value:!!r}),n.$events[e].push(l)})),off:t((function(e,t,r){const n=this;let o,s;e=e.toLowerCase().split(":",1)[0];const a=n.$events[e];if(null!=a){for(r=!!r,s=a.length;s&&s--;)o=a[s],(null!=t||r)&&(o.fn!=t||o.sticky&&o.sticky!=r)||n.$events[e].splice(s,1);0==a.length&&delete n.$events[e]}})),resolve(e){e=e.toLowerCase();const t=this,r=arguments.length>1?[].slice.call(arguments,1):[];return Promise.all((t.$events[e]||[]).concat().map(e=>new Promise(n=>{n(e.cb.apply(t,r))})))},addPseudo(e,t){return this.$pseudo[e]=t,this}};function normalize(e="GET"){return Array.isArray(e)||(e=[e]),e.forEach(e=>e==o||"HEAD"==e?"GET":e.toUpperCase()),e}r.addPseudo("once",(function(e){return e.cb=function(){const t=this,r=e.fn.apply(t,arguments);return t.off(e.name,e.fn),r},this}));class n{constructor(){this.routers=Object.create(o),this.defaultRouter=Object.create(o)}getRouter(e){const t=e!=o&&e.request.method||"GET",r=this.routers[t]||[],n=r.length;let s,a=0;for(;a<n;a++)if(s=r[a],s.match(e))return s;return this.defaultRouter[t]}registerRoute(e,t="GET"){return normalize(t).forEach(t=>{t in this.routers||(this.routers[t]=[]),this.routers[t].push(e)}),this}unregisterRoute(e,t){return normalize(t).forEach(t=>{const r=this.routers[t]||[],n=r.indexOf(e);-1!=n&&r.splice(n,1)}),this}setDefaultRouter(e,t){normalize(t).forEach(t=>this.defaultRouter[t]=e)}getDefaultRouter(){for(let e in this.defaultRouter)return this.defaultRouter[e];return o}}e.merge(!0,n.prototype,r),e.merge(!0,class{constructor(e,t,r=null){const n=this;n.plugins=[],n.options=Object.assign(Object.create(o),{mime:[]},r||{}),n.path=e,n.strategy=t.name,n.handler={handle:async e=>{let r,o;for(r of n.plugins)try{if(o=await r.precheck(e),o instanceof Response)return o}catch(e){console.error({error:e})}if(o=await t.handle(e),o instanceof Response)for(r of n.plugins)try{await r.postcheck(e,o)}catch(e){console.error(e.message)}return o}}}addPlugin(e){return this.plugins.includes(e)||this.plugins.push(e),this}match(e,t){return!0}}.prototype,r);const o=null,s=Object.create(o);e.merge(!0,s,r),Object.defineProperties(s,{app:{value:Object.create(o)},routes:{value:new n}}),Object.defineProperties(s.app,{name:{value:"gzip",enumerable:!0},scope:{value:"{scope}",enumerable:!0},route:{value:"{ROUTE}",enumerable:!0},cacheName:{value:"{CACHE_NAME}",enumerable:!0},codeName:{value:"Joomla Website Optimizer Plugin",enumerable:!0},build:{value:"{VERSION}",enumerable:!0},buildid:{value:"build-id",enumerable:!0},builddate:{value:"build-date",enumerable:!0},urls:{value:"{CDN_HOSTS}",enumerable:!0},backgroundSync:{value:"{BACKGROUND_SYNC}",enumerable:!0},offline:{value:"{pwa_offline_page}"},network:{value:"{pwa_cache_settings}"},precache:{value:"{preloaded_urls}".map(e=>new URL(e,self.origin).href),enumerable:!0},homepage:{value:"https://github.com/tbela99/gzip",enumerable:!0}});const a=["method","referrer","referrerPolicy","mode","credentials","cache","redirect","integrity","keepalive"];class i{async push(e){const t=await this.cloneRequestData(e),r=await this.getDB();return await r.put({id:hashCode(e.url+a.map(async e=>{let r=t[e];return r==o?"":"headers"==e?r instanceof Headers?[...r.values()].filter(e=>e!=o).join(""):Object.values(r).map(r=>t[e][r]!=o?t[e][r]:"").join(""):"body"==e?await r.text():r}).join("")),lastRetry:Date.now()+864e5,url:e.url,request:t}),this}async cloneRequestData(e){const t={headers:{}};"GET"!==e.method&&(t.body=await e.clone().arrayBuffer());for(const[r,n]of e.headers.entries())t.headers[r]=n;for(const r of a)void 0!==e[r]&&(t[r]=e[r]);return"navigate"===t.mode&&(t.mode="same-origin"),t}async getDB(){return this.db==o&&(this.db=await async function(e,t="id",r=[]){return new Promise((n,o)=>{const s=indexedDB.open(e,1),a=`${e}_store`;let i;const _query=(e,t,r=null,n=null)=>new Promise((o,s)=>{const l=t?"readonly":"readwrite";if(i.objectStoreNames.contains(a)){const t=i.transaction(a,l),c=t.objectStore(a);let u;"put"===e&&r&&void 0!==r.length?(u=t,r.forEach(e=>{c.put(e)})):(n&&c.index(n),u=c[e](r)),u.oncomplete=e=>{o(e.target.result)},u.onsuccess=e=>{o(e.target.result)},u.onerror=e=>{s(e)}}else s(new Error("Store not found"))}),l={count:async()=>{const e=i.transaction(a,"readonly").objectStore(a).count();return new Promise((function(t,r){e.onsuccess=function(e){t(e.target.result)},e.onerror=function(e){r(e)}}))},get:(e,t)=>_query("get",!0,e,t),getAll:(e,t)=>_query("getAll",!0,e,t),put:e=>_query("put",!1,e),delete:e=>_query("delete",!1,e),clear:()=>_query("clear",!1),deleteDatabase:()=>new Promise((function(e,t){const r=indexedDB.deleteDatabase;r.onerror=t,r.onsuccess=e}))};s.onupgradeneeded=(()=>{i=s.result;const e=i.createObjectStore(a,{keyPath:t});let n;for(n of r)e.createIndex(n.name,n.key,n.options)}).bind(this),s.onsuccess=(()=>{i=s.result,n(l)}).bind(this),s.onerror=(e=>{o(new Error(e.originalTarget&&e.originalTarget.error||e))}).bind(this)})}("gzip_sw_worker_sync_requests","id")),this.db}async replay(e){if("{SYNC_API_TAG}"!=e)return;const t=await this.getDB(),r=await t.getAll();r.length;const n=await caches.open("{CACHE_NAME}");for(const e of r){let r=!1;try{e.request.method,e.url;const t=new Request(e.url,e.request);let s=await n.match(t);r=s!=o,r||(s=await fetch(t.clone()),r=s!=o&&s.ok,r&&isCacheableRequest(t,s)&&await n.put(t,s))}catch(e){}(r||e.lastRetry<=Date.now())&&await t.delete(e.id)}}}if("{BACKGROUND_SYNC}".enabled){const e=new i;let t=0;const r=function(e=1){return e*=3600,function(t){return t>12.8139&&(t=12.8139),1e3*Math.min(e,.5*(2**t-1))}}();setTimeout((async function replay(){await e.replay("{SYNC_API_TAG}"),setTimeout(replay,r(++t))}),r(t))}}();